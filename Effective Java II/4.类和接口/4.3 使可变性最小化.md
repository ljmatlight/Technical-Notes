# 第四章 类和接口

## 4.3 使可变性最小化

### `final` 类的五条规则

- 不要提供任何修改对象属性的方法。
- 保证类不会被继承。
- 使所有的域都是 `final` 的。
- 使所有的域都是私有的。
- 确保对于任何可变组件的互斥访问。

### 其他

> 函数式做法（不推荐使用，期间可能产生大量无用对象）

> 不可变的对象本质上是线程安全的，它们不要求同步，可以被自由地共享。

> 配套类： 例如 `String` 类的 `StringBuilder` 类。

> 不可变的类可以提供一些静态工厂。它们把频繁被请求的实例缓存起来，
> 从而当现有实例可以符合请求的时候，就不必创建新的实例。
> 从而降低内存占用和垃圾回收的成本。

> 在设计新类的时，选择用静态工厂代替公用的构造器可以让程式具有添加缓存的灵活性，
> 而不影响客户端。

### 最佳实践

> 让类的所有构造器都变成私有的或者是包级私有的，并添加公用的静态工厂来替代公用的构造器。

> 绝不要为每个 `get` 方法编写一个相应的 `set` 方法。
> 除非有很好的理由要让类成为可变的类，否则就应该是不可变的。

> 构造器应该创建完成初始化的对象，并建立起所有的约束关系。
> 不要在构造器或静态工厂之外再提供公用的初始化方法。
